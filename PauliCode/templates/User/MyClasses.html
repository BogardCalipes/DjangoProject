{% load static %}
{% include "partials/header.html" %}

<body class="g-sidenav-show text-white" style="background-color: #273149">
  <div class="min-height-300 position-absolute w-100"></div>

  {% include "partials/sidebar.html" %} <!-- Sidebar -->

  <main class="main-content position-relative border-radius-lg p-4">

    <!-- Header Row: Title + Search -->
    <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap">
      <h4 class="fw-bold text-white mb-2 mb-md-0">My Classes</h4>
      
      <form class="d-flex" method="GET">
        <input 
          class="form-control form-control-sm" 
          style="width: 40vh; height: 5vh; border: 1px solid #ced4da; border-radius: 0.25rem;" 
          type="search" 
          name="q" 
          placeholder="Search classes..." 
          aria-label="Search"
          value="{{ request.GET.q|default:'' }}">
          
        <button class="btn btn-outline-success btn-sm ms-2" type="submit">Search</button>
      </form>
    </div>

    <!-- Classes Grid -->
    <div class="row g-3">
      {% if classes %}
        {% for cls in classes %}
          {% if not request.GET.q or request.GET.q|lower in cls.title|lower or request.GET.q|lower in cls.class_code|lower %}
            <div class="col-6 col-sm-4 col-md-3 col-lg-2">
              <div class="card text-center border-0 rounded-4 shadow-sm text-white {% cycle 'color-green' 'bg-dark' %} position-relative cls-card">

                <!-- Delete Button (hover) -->
                <a href="{% url 'delete_class' cls.class_id %}" 
                   class="btn btn-sm btn-danger position-absolute top-0 end-0 m-2 delete-btn"
                   onclick="return confirm('Are you sure you want to delete this class?');">
                  Delete
                </a>

                <div class="card-body d-flex flex-column justify-content-center align-items-center p-2">
                  <!-- Bigger thumbnail relative to smaller card -->
                  <img src="{{ cls.upload_icon.url|default:'/media/class_icons/defaultClassIcon.png' }}" 
                       alt="Class Icon" 
                       class="rounded mb-2 cls-img">

                  <h6 class="fw-bold mt-1 text-white">{{ cls.title }}</h6>
                  <p class="small text-light mb-0">{{ cls.class_code }}</p>
                </div>
              </div>
            </div>
          {% endif %}
        {% endfor %}
      {% else %}
        <p class="text-muted">No classes created yet.</p>
      {% endif %}
    </div>

  </main>

  {% include "partials/footer.html" %}
  {% include "partials/scripts.html" %}

  <style>
    /* Card hover effect */
    .cls-card {
      width: 200px;   /* smaller square width */
      height: 200px;  /* smaller square height */
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .cls-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.4);
    }

    /* Delete button initially hidden */
    .delete-btn {
      display: none;
    }
    .cls-card:hover .delete-btn {
      display: block;
    }

    /* Smaller card body */
    .cls-card .card-body {
      padding: 0.5rem !important;
    }

    /* Thumbnail size bigger relative to card */
    .cls-card .cls-img {
      width: 80px;
      height: 80px;
      object-fit: cover;
    }

    /* Search box focus outline success */
    input[name="q"]:focus {
      border-color: #198754; /* Bootstrap 'success' color */
      box-shadow: 0 0 0 0.2rem rgba(25, 135, 84, 0.25);
      outline: none;
    }

    .color-green{
        background-color: rgb(35, 103, 51);
    }
  </style>
</body>
</html>
